# SSPanel install_debian12.sh 脚本修改说明

## 修改概述

根据 SSPanel 官方手册 (https://docs.sspanel.io/docs/installation/manual-install/) 的要求，对 `install_debian12.sh` 脚本进行了以下重要修改，以确保符合最新的官方安装要求。

## 主要修改内容

### 1. PHP 版本升级 (重要)
- **原版本**: PHP 8.2
- **修改后**: PHP 8.4 (按官方推荐)
- **原因**: 官方要求 PHP 8.2+ 且推荐使用 8.4 获得更好性能和安全性

### 2. 添加官方软件仓库
**新增内容**:
- 添加 Nginx 官方仓库以确保版本满足 1.24+ 要求
- 添加 PHP 8.4 官方仓库 (packages.sury.org)
- 设置仓库优先级确保安装正确版本

### 3. PHP 扩展完善
**原有扩展**: 基础扩展
**新增扩展**:
- `php8.4-gmp` (数学运算扩展，必需)
- `php8.4-yaml` (YAML 支持，必需)
- `php8.4-opcache` (性能优化，强烈推荐)
- `php8.4-soap` (SOAP 协议支持)
- `php8.4-bz2` (压缩支持)
- `php8.4-igbinary` (高性能序列化)
- `php8.4-readline` (命令行支持)

### 4. 系统要求检查
**新增功能**:
- 检查操作系统版本 (警告非 Debian 12)
- 检查 root 权限
- 检查内存是否满足最低要求 (1GB)
- 检查磁盘空间是否充足 (10GB)

### 5. PHP 扩展验证
**新增功能**:
- 自动验证所有官方要求的 PHP 扩展是否正确安装
- 检查扩展列表: bcmath, curl, fileinfo, gmp, json, mbstring, mysqli, openssl, pdo, posix, redis, sodium, xml, yaml, zip, opcache

### 6. 配置改进
**PHP 配置**:
- 按官方推荐调整 memory_limit 为 256M (而非 512M)
- 调整上传文件大小限制为 50M (符合官方建议)
- 添加时区设置为 Asia/Shanghai

**Nginx 配置**:
- 确保 Nginx 用户设置为 www-data
- 更新 PHP-FPM socket 路径到 8.4 版本

### 7. 增强的输出信息
**新增内容**:
- 显示所有已安装软件的版本信息
- 提供详细的后续配置步骤
- 添加 PHP 扩展验证命令

## 官方手册对比检查

### ✅ 已满足的要求:
- PHP 8.2+ ✅ (使用 8.4)
- 所有必需的 PHP 扩展 ✅
- MariaDB 支持 ✅
- Redis 支持 ✅
- Nginx 1.24+ ✅ (通过官方仓库)
- HTTPS 支持 ✅ (Let's Encrypt)

### ⚠️ 需要注意的点:
1. **域名配置**: 脚本硬编码为 `yuebin.uk`，实际使用需要修改
2. **SSL 证书**: 依赖外部域名解析，本地测试时可能失败
3. **MariaDB 版本**: 使用系统默认版本，官方推荐 10.11+ 和 11.8 LTS

### 📝 建议的后续改进:
1. 添加域名配置参数化
2. 添加 MariaDB 版本检查
3. 添加 Redis 版本检查 (要求 7.0+)
4. 提供离线安装选项

## 使用建议

1. **安装前**: 确保服务器满足硬件要求 (1GB+ RAM, 10GB+ 存储)
2. **域名配置**: 修改脚本中的 `DOMAIN` 变量为实际域名
3. **网络要求**: 确保能够访问 GitHub 和相关软件仓库
4. **系统要求**: 推荐在全新的 Debian 12 系统上运行

## 修改后的优势

1. **完全符合官方要求**: 所有软件版本和扩展都满足官方最新标准
2. **更好的错误检查**: 提前发现和报告潜在问题
3. **详细的验证步骤**: 确保安装的每个组件都正常工作
4. **更好的维护性**: 使用官方仓库便于后续更新

这些修改确保了脚本与 SSPanel 官方手册的完全一致性，提高了安装成功率和系统稳定性。